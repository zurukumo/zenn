---
title: "MacOSã‚’Montereyã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ãŸã‚‰vagrant upãŒå®Ÿè¡Œã§ããªããªã‚‹å•é¡Œ"
emoji: "ğŸŒ§ï¸"
type: "tech"
topics:
  - "vagrant"
  - "virtualbox"
published: true
published_at: "2021-11-03 16:07"
---

## 2021/11/26 è¿½è¨˜
https://www.virtualbox.org/ticket/20636
2021/11/22ã®Virtual Boxã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã§å½“è©²ã®å•é¡Œã¯ä¿®æ­£ã•ã‚ŒãŸæ§˜å­ã€‚Virtual Boxã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’6.1.30ä»¥ä¸Šã«ã™ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã™ã‚‹ã€‚

## MacOSã‚’ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã™ã‚‹ã¨vagrant upãŒå®Ÿè¡Œã§ããªããªã‚‹
å…ˆæ—¥ã€MacOSã‚’Montereyã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ãŸã¨ã“ã‚ã€vagrant upãŒå®Ÿè¡Œã§ããªããªã£ãŸã€‚äººã«ã‚ˆã£ã¦å¾®å¦™ã«ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ç•°ãªã‚‹ã‚ˆã†ã ãŒã€è‡ªåˆ†ã®å ´åˆã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ãŸã€‚

```sh
$ vagrant up
Bringing machine 'default' up with 'virtualbox' provider...
==> default: Checking if box 'ubuntu/xenial64' version '20210112.0.0' is up to date...
==> default: Clearing any previously set forwarded ports...
==> default: Clearing any previously set network interfaces...
==> default: Preparing network interfaces based on configuration...
    default: Adapter 1: nat
==> default: Forwarding ports...
    default: 8020 (guest) => 8020 (host) (adapter 1)
    default: 8080 (guest) => 8080 (host) (adapter 1)
    default: 22 (guest) => 2222 (host) (adapter 1)
==> default: Running 'pre-boot' VM customizations...
==> default: Booting VM...

There was an error while executing `VBoxManage`, a CLI used by Vagrant
for controlling VirtualBox. The command and stderr is shown below.

Command: ["startvm", "7341fcfb-9b24-4972-9f1e-ca45dda2bfcb", "--type", "headless"]

Stderr: VBoxManage: error: The virtual machine 'amazon-api_default_1632198788047_76720' has terminated unexpectedly during startup because of signal 10
VBoxManage: error: Details: code NS_ERROR_FAILURE (0x80004005), component MachineWrap, interface IMachine
```

## åŸå› 
Virtual Boxã®ãƒ•ã‚©ãƒ¼ãƒ©ãƒ ã‚„Vagrantã®Github Issuesãªã©ã§å•é¡Œã®è­°è«–ãŒãªã•ã‚Œã¦ã„ã‚‹ã€‚
- [Cannot start VirtualBox on macOS Monterey](https://forums.virtualbox.org/viewtopic.php?f=8&t=104249)
- [Vagrant up issues in Mac OS Monterey](https://github.com/hashicorp/vagrant/issues/12557)

ã©ã†ã‚„ã‚‰Virtual Boxã®headlessãƒ¢ãƒ¼ãƒ‰ãŒMontereyä¸Šã ã¨ãƒã‚°ã£ã¦ã—ã¾ã†ã“ã¨ãŒåŸå› ã®ã‚ˆã†ã ã€‚
ã—ãŸãŒã£ã¦headlessãƒ¢ãƒ¼ãƒ‰ã‚’ä¸€æ—¦ã‚ªãƒ•ã«ã—ã¦ã€guiãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•ã™ã‚Œã°ã¨ã‚Šã‚ãˆãšã®å¯¾å¿œã«ã¯ãªã‚‹ã€‚

## å¯¾å¿œ
1. Vagrantfileã«Virtual Boxã‚’guiãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•ã™ã‚‹ã‚ˆã†ã«æŒ‡å®šã™ã‚‹ã€‚
```rb:Vagrantfile
config.vm.provider :virtualbox do |vb|
	vb.gui = true
end
```

2. Macã®ã‚«ãƒ¼ãƒãƒ«ã«Virtual Boxã®ãƒ‰ãƒ©ã‚¤ãƒãªã©ã‚’å†èª­è¾¼ã•ã›ã‚‹ã€‚
```sh 
sudo kextload -b org.virtualbox.kext.VBoxDrv;
sudo kextload -b org.virtualbox.kext.VBoxNetFlt;
sudo kextload -b org.virtualbox.kext.VBoxNetAdp;
sudo kextload -b org.virtualbox.kext.VBoxUSB;
```

ä»¥ä¸Šã®2ã‚¹ãƒ†ãƒƒãƒ—ã‚’è¡Œã†ã“ã¨ã§è‡ªåˆ†ã®å ´åˆã¯vagrant upã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚
ãŸã ã—ã€guiãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•ã™ã‚‹ã¨ä»¥ä¸‹ã®ç”»åƒã®ã‚ˆã†ãªVirtual Boxã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒå‡ºã¦ã—ã¾ã†ã“ã¨ã«æ³¨æ„ã€‚
![](https://storage.googleapis.com/zenn-user-upload/e76d7073bfbc7608f6a092e9.png)

Virtual Boxã®é–‹ç™ºå´ã‚‚ã“ã®å•é¡Œã¯èªçŸ¥ã—ã¦ã„ã¦ã€ç¾åœ¨ã€å¿…æ­»ã§ä¿®æ­£ã«ã‚ãŸã£ã¦ã„ã‚‹ãã†ã ã€‚ã¾ã MacOSã‚’Montereyã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ã¦ã„ãªã„ã¨ã„ã†æ–¹ã¯ã€Virtual Boxã®ä¿®æ­£ãŒçµ‚ã‚ã‚‹ã¾ã§ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã‚’ä¿ç•™ã™ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã™ã‚‹ã€‚